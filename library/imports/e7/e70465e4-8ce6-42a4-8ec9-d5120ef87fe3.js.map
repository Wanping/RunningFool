{"version":3,"sources":["assets\\script\\utils\\eventCenter.js"],"names":["EventGroup","head","iter","length","prototype","getLength","addObserver","observer","target","ob","next","node","last","removeObserver","removeAll","emitByArray","array","temp","call","emit","arguments","eventCenter","_eventGroup","getEventGroup","evt","addEventObserver","console","log","eg","removeEventObserver","emitEvent","params","emitEventByArray","key","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nfunction EventGroup() {\r\n\r\n    this.head = null;\r\n    this.iter = null;\r\n    this.length = 0;\r\n\r\n    EventGroup.prototype.getLength = function () {\r\n        return this.length;\r\n    }\r\n\r\n    EventGroup.prototype.addObserver = function (observer, target) {\r\n        if (observer == null) return;\r\n        if (this.head == null) {\r\n            this.head = {ob: observer, target:target, next: null};\r\n            this.length = 1;\r\n            return;\r\n        }\r\n\r\n        var node = this.head;\r\n        var last = null;\r\n        while (node != null) {\r\n            if (node.ob === observer && node.target === target) {\r\n                return;\r\n            }\r\n            last = node;\r\n            node = node.next;\r\n        }\r\n        this.length += 1;\r\n        last.next = {ob: observer, target: target, next: null};\r\n    }\r\n\r\n    EventGroup.prototype.removeObserver = function (observer, target) {\r\n        if (observer == null || this.head == null) return;\r\n        if (this.head.ob === observer && this.head.target === target) {\r\n            if(this.head === this.iter) {\r\n                this.iter = this.iter.next;\r\n            }\r\n            this.head = this.head.next;\r\n            this.length --;\r\n            return;\r\n        }\r\n        var node = this.head;\r\n        while (node.next != null) {\r\n            if (node.next.ob === observer && node.next.target === target) {\r\n                if (this.iter === node.next) {\r\n                    this.iter = node.next.next;\r\n                }\r\n                node.next = node.next.next;\r\n                this.length --;\r\n                return;\r\n            }\r\n            node = node.next;\r\n        }\r\n    }\r\n\r\n    EventGroup.prototype.removeAll = function () {\r\n        this.iter = null;\r\n        this.head = null;\r\n        this.length = 0;\r\n    }\r\n\r\n    EventGroup.prototype.emitByArray = function (array) {\r\n        this.iter = this.head;\r\n        while (this.iter != null) {\r\n            var temp = this.iter;\r\n            if (temp.target) {\r\n                temp.ob.call(temp.target, array);\r\n            }\r\n            else {\r\n                temp.ob(array);\r\n            }\r\n\r\n            if (this.iter && temp === this.iter) {\r\n                this.iter = this.iter.next;\r\n            }\r\n        }\r\n        this.iter = null;\r\n    }\r\n\r\n\r\n    EventGroup.prototype.emit = function () {\r\n        this.iter = this.head;\r\n        while (this.iter != null) {\r\n            var temp = this.iter;\r\n            if (temp.target) {\r\n                temp.ob.call(temp.target, ...arguments);\r\n            }\r\n            else {\r\n                temp.ob(...arguments);\r\n            }\r\n\r\n            if(this.iter && temp === this.iter) {\r\n                this.iter = this.iter.next;\r\n            }\r\n        }\r\n        this.iter = null;\r\n    }\r\n}\r\n\r\nvar eventCenter = {\r\n\r\n    _eventGroup: {},\r\n\r\n    getEventGroup: function (evt) {\r\n        return eventCenter._eventGroup[evt];\r\n    },\r\n\r\n    addEventObserver: function (evt, observer, target) {\r\n        if(evt == null) {\r\n            console.log(\"addEventObserver evt is null\");\r\n            return;\r\n        }\r\n\r\n        var eg = eventCenter.getEventGroup(evt);\r\n        if (!eg) {\r\n            eg = new EventGroup();\r\n            eventCenter._eventGroup[evt] = eg;\r\n        }\r\n        eg.addObserver(observer, target);\r\n    },\r\n\r\n    removeEventObserver: function (evt, observer, target) {\r\n        if(evt == null) {\r\n            console.log(\"removeEventObserver evt is null\");\r\n            return;\r\n        }\r\n        var eg = eventCenter.getEventGroup(evt);\r\n        if (!eg) {\r\n            eg.removeObserver(observer, target);\r\n            if (eg.getLength() === 0) {\r\n                delete eventCenter._eventGroup[evt];\r\n            }\r\n        }\r\n    },\r\n\r\n    emitEvent: function (evt, ...params) {\r\n        if(evt == null) {\r\n            console.log(\"emitEvent evt is null\");\r\n            return;\r\n        }\r\n        var eg = eventCenter.getEventGroup(evt);\r\n        if(eg) {\r\n            eg.emit(...params);\r\n        }\r\n    },\r\n\r\n    emitEventByArray: function (evt, array) {\r\n        if(evt == null) {\r\n            console.log(\"emitEventByArray evt is null\");\r\n            return;\r\n        }\r\n        var eg = eventCenter.getEventGroup(evt);\r\n        if(eg) {\r\n            eg.emitByArray(array);\r\n        }\r\n    },\r\n\r\n    removeAll: function () {\r\n        var eg = eventCenter._eventGroup;\r\n        for (var key in eg) {\r\n            eg[key].removeAll();\r\n        }\r\n        eventCenter._eventGroup = null;\r\n    }\r\n};\r\n\r\nmodule.exports = eventCenter;"]}