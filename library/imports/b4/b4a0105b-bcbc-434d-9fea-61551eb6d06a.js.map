{"version":3,"sources":["assets\\script\\login\\LoginController.js"],"names":["gameDef","require","singleton","wechatSdk","eventCenter","eventDef","cc","Class","Component","properties","ProgressBar","type","LabelTip","Label","NodeBtnLogin","Node","onLoad","curScene","Scene","Login","node","active","registerEvent","initLoginModule","onDestroy","unregisterEvent","addEventObserver","PreloadScene","preloadAllScene","removeEventObserver","onClickWxLogin","isWeChat","login","self","hideLoginBtn","progressFunc","progress","string","toFixed","console","log","successFuc","director","loadScene","Hall","loadManager","loadAllScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["let gameDef = require(\"gameDef\");\r\nlet singleton = require(\"singleton\");\r\nlet wechatSdk = require(\"wechatSdk\");\r\nlet eventCenter = require(\"eventCenter\");\r\nlet eventDef = require(\"eventDef\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ProgressBar: {\r\n            type: cc.ProgressBar,\r\n            default: null\r\n        },\r\n\r\n        LabelTip: {\r\n            type: cc.Label,\r\n            default: null\r\n        },\r\n\r\n        NodeBtnLogin: {\r\n            type: cc.Node,\r\n            default: null\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        singleton.curScene = gameDef.Scene.Login;\r\n        this.LabelTip.node.active = false;\r\n        this.ProgressBar.node.active = false;\r\n        this.registerEvent();\r\n        this.initLoginModule();\r\n    },\r\n\r\n    onDestroy () {\r\n        this.unregisterEvent();\r\n    },\r\n\r\n    registerEvent () {\r\n        eventCenter.addEventObserver(eventDef.PreloadScene, this.preloadAllScene, this);\r\n    },\r\n\r\n    unregisterEvent () {\r\n        eventCenter.removeEventObserver(eventDef.PreloadScene, this.preloadAllScene, this);\r\n    },\r\n\r\n    initLoginModule () {\r\n        this.wechatSdk = new wechatSdk();\r\n    },\r\n\r\n    onClickWxLogin () {\r\n        if (this.wechatSdk.isWeChat()) {\r\n            this.wechatSdk.login();\r\n        }\r\n        else {\r\n            this.preloadAllScene();\r\n        }\r\n    },\r\n\r\n    preloadAllScene () {\r\n        let self = this;\r\n        this.hideLoginBtn();\r\n        this.LabelTip.node.active = true;\r\n        this.ProgressBar.node.active = true;\r\n        let progressFunc = function (progress) {\r\n            if (!self.ProgressBar) return;\r\n            if (progress >= 1) {\r\n                self.ProgressBar.progress = 1;\r\n                self.LabelTip.string = \"正在进入游戏，请耐心等待～\";\r\n                return;\r\n            }\r\n            self.ProgressBar.progress = progress;\r\n            self.LabelTip.string = \"正在进入游戏，当前加载 \" + (progress * 100).toFixed(2) + \"%\";\r\n            console.log(\"正在进入游戏，当前加载 \" + (progress * 100).toFixed(2) + \"%\");\r\n        };\r\n\r\n        let successFuc = function () {\r\n            cc.director.loadScene(gameDef.Scene.Hall);\r\n        };\r\n\r\n        singleton.loadManager.loadAllScene(progressFunc, successFuc);\r\n    },\r\n\r\n    hideLoginBtn () {\r\n        if(!this.node) return;\r\n        this.NodeBtnLogin.active = false;\r\n    },\r\n\r\n});\r\n"]}