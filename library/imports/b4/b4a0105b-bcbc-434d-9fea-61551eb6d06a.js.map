{"version":3,"sources":["assets/script/login/LoginController.js"],"names":["gameDef","require","singleton","wechatSdk","eventCenter","eventDef","cc","Class","Component","properties","ProgressBar","type","LabelTip","Label","NodeBtnLogin","Node","onLoad","curScene","Scene","Login","node","active","registerEvent","initLoginModule","onDestroy","unregisterEvent","addEventObserver","loadAllPrefab","onLoadAllPrefab","removeEventObserver","onClickWxLogin","isWeChat","login","onLoadPrefab","self","hideLoginBtn","progressFunc","progress","string","toFixed","console","log","successFuc","director","loadScene","Hall","loadManager","loadAllScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["let gameDef = require(\"gameDef\");\nlet singleton = require(\"singleton\");\nlet wechatSdk = require(\"wechatSdk\");\nlet eventCenter = require(\"eventCenter\");\nlet eventDef = require(\"eventDef\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        ProgressBar: {\n            type: cc.ProgressBar,\n            default: null\n        },\n\n        LabelTip: {\n            type: cc.Label,\n            default: null\n        },\n\n        NodeBtnLogin: {\n            type: cc.Node,\n            default: null\n        }\n    },\n\n    onLoad () {\n        singleton.curScene = gameDef.Scene.Login;\n        this.LabelTip.node.active = false;\n        this.ProgressBar.node.active = false;\n        this.registerEvent();\n        this.initLoginModule();\n    },\n\n    onDestroy () {\n        this.unregisterEvent();\n    },\n\n    registerEvent () {\n        eventCenter.addEventObserver(eventDef.loadAllPrefab, this.onLoadAllPrefab, this);\n    },\n\n    unregisterEvent () {\n        eventCenter.removeEventObserver(eventDef.loadAllPrefab, this.onLoadAllPrefab, this);\n    },\n\n    initLoginModule () {\n        this.wechatSdk = new wechatSdk();\n    },\n\n    onClickWxLogin () {\n        if (this.wechatSdk.isWeChat()) {\n            this.wechatSdk.login();\n        }\n        else {\n            this.onLoadPrefab();\n        }\n    },\n\n    onLoadPrefab () {\n        let self = this;\n        this.hideLoginBtn();\n        this.LabelTip.node.active = true;\n        this.ProgressBar.node.active = true;\n        let progressFunc = function (progress) {\n            if (!self.ProgressBar) return;\n            if (progress >= 1) {\n                self.ProgressBar.progress = 1;\n                self.LabelTip.string = \"正在进入游戏，请耐心等待～\";\n                return;\n            }\n            self.ProgressBar.progress = progress;\n            self.LabelTip.string = \"正在进入游戏，当前加载 \" + (progress * 100).toFixed(2) + \"%\";\n            console.log(\"正在进入游戏，当前加载 \" + (progress * 100).toFixed(2) + \"%\");\n        };\n\n        let successFuc = function () {\n            cc.director.loadScene(gameDef.Scene.Hall);\n        };\n\n        singleton.loadManager.loadAllScene(progressFunc, successFuc);\n    },\n\n    hideLoginBtn () {\n        if(!this.node) return;\n        this.NodeBtnLogin.active = false;\n    },\n\n});\n"]}