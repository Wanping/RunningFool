{"version":3,"sources":["assets\\script\\login\\LoginController.js"],"names":["gameDef","require","singleton","wechatSdk","cc","Class","Component","properties","ProgressBar","type","LabelTip","Label","onLoad","curScene","Scene","Login","node","active","initLoginModule","onClickWxLogin","self","isWeChat","login","preloadAllScene","progressFunc","progress","string","toFixed","console","log","successFuc","director","loadScene","Hall","loadManager","loadAllScene"],"mappings":";;;;;;AAAA,IAAIA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIE,SAAS,GAAGF,OAAO,CAAC,WAAD,CAAvB;;AAEAG,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,WAAW,EAAE;AACTC,MAAAA,IAAI,EAAEL,EAAE,CAACI,WADA;AAET,iBAAS;AAFA,KADL;AAMRE,IAAAA,QAAQ,EAAE;AACND,MAAAA,IAAI,EAAEL,EAAE,CAACO,KADH;AAEN,iBAAS;AAFH;AANF,GAHP;AAeLC,EAAAA,MAfK,oBAeK;AACNV,IAAAA,SAAS,CAACW,QAAV,GAAqBb,OAAO,CAACc,KAAR,CAAcC,KAAnC;AACA,SAAKL,QAAL,CAAcM,IAAd,CAAmBC,MAAnB,GAA4B,KAA5B;AACA,SAAKT,WAAL,CAAiBQ,IAAjB,CAAsBC,MAAtB,GAA+B,KAA/B;AACA,SAAKC,eAAL;AACH,GApBI;AAsBLA,EAAAA,eAtBK,6BAsBc;AACf,SAAKf,SAAL,GAAiB,IAAIA,SAAJ,EAAjB;AACH,GAxBI;AA0BLgB,EAAAA,cA1BK,4BA0Ba;AACd,QAAIC,IAAI,GAAG,IAAX;AACA,SAAKV,QAAL,CAAcM,IAAd,CAAmBC,MAAnB,GAA4B,IAA5B;AACA,SAAKT,WAAL,CAAiBQ,IAAjB,CAAsBC,MAAtB,GAA+B,IAA/B;;AACA,QAAI,KAAKd,SAAL,CAAekB,QAAf,EAAJ,EAA+B;AAC3B,WAAKlB,SAAL,CAAemB,KAAf,CAAqB,YAAY;AAC7BF,QAAAA,IAAI,CAACG,eAAL;AACH,OAFD;AAGH,KAJD,MAKK;AACD,WAAKA,eAAL;AACH;AACJ,GAtCI;AAwCLA,EAAAA,eAxCK,6BAwCc;AACf,QAAIH,IAAI,GAAG,IAAX;;AACA,QAAII,YAAY,GAAG,SAAfA,YAAe,CAAUC,QAAV,EAAoB;AACnC,UAAI,CAACL,IAAI,CAACZ,WAAV,EAAuB;;AACvB,UAAIiB,QAAQ,IAAI,GAAhB,EAAqB;AACjBL,QAAAA,IAAI,CAACZ,WAAL,CAAiBiB,QAAjB,GAA4B,GAA5B;AACAL,QAAAA,IAAI,CAACV,QAAL,CAAcgB,MAAd,GAAuB,eAAvB;AACA;AACH;;AACDN,MAAAA,IAAI,CAACZ,WAAL,CAAiBiB,QAAjB,GAA4BA,QAA5B;AACAL,MAAAA,IAAI,CAACV,QAAL,CAAcgB,MAAd,GAAuB,gBAAgB,CAACD,QAAQ,GAAG,GAAZ,EAAiBE,OAAjB,CAAyB,CAAzB,CAAhB,GAA8C,GAArE;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgB,CAACJ,QAAQ,GAAG,GAAZ,EAAiBE,OAAjB,CAAyB,CAAzB,CAAhB,GAA8C,GAA1D;AACH,KAVD;;AAYA,QAAIG,UAAU,GAAG,SAAbA,UAAa,GAAY;AACzB1B,MAAAA,EAAE,CAAC2B,QAAH,CAAYC,SAAZ,CAAsBhC,OAAO,CAACc,KAAR,CAAcmB,IAApC;AACH,KAFD;;AAIA/B,IAAAA,SAAS,CAACgC,WAAV,CAAsBC,YAAtB,CAAmCX,YAAnC,EAAiDM,UAAjD;AACH;AA3DI,CAAT","sourceRoot":"/","sourcesContent":["let gameDef = require(\"gameDef\");\r\nlet singleton = require(\"singleton\");\r\nlet wechatSdk = require(\"wechatSdk\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ProgressBar: {\r\n            type: cc.ProgressBar,\r\n            default: null\r\n        },\r\n\r\n        LabelTip: {\r\n            type: cc.Label,\r\n            default: null\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        singleton.curScene = gameDef.Scene.Login;\r\n        this.LabelTip.node.active = false;\r\n        this.ProgressBar.node.active = false;\r\n        this.initLoginModule();\r\n    },\r\n\r\n    initLoginModule () {\r\n        this.wechatSdk = new wechatSdk();\r\n    },\r\n\r\n    onClickWxLogin () {\r\n        var self = this;\r\n        this.LabelTip.node.active = true;\r\n        this.ProgressBar.node.active = true;\r\n        if (this.wechatSdk.isWeChat()) {\r\n            this.wechatSdk.login(function () {\r\n                self.preloadAllScene();\r\n            });\r\n        }\r\n        else {\r\n            this.preloadAllScene();\r\n        }\r\n    },\r\n\r\n    preloadAllScene () {\r\n        let self = this;\r\n        let progressFunc = function (progress) {\r\n            if (!self.ProgressBar) return;\r\n            if (progress >= 100) {\r\n                self.ProgressBar.progress = 100;\r\n                self.LabelTip.string = \"正在进入游戏，请耐心等待～\";\r\n                return;\r\n            }\r\n            self.ProgressBar.progress = progress;\r\n            self.LabelTip.string = \"正在进入游戏，当前加载\" + (progress * 100).toFixed(2) + \"%\";\r\n            console.log(\"正在进入游戏，当前加载\" + (progress * 100).toFixed(2) + \"%\");\r\n        };\r\n\r\n        let successFuc = function () {\r\n            cc.director.loadScene(gameDef.Scene.Hall);\r\n        };\r\n\r\n        singleton.loadManager.loadAllScene(progressFunc, successFuc);\r\n    }\r\n\r\n});\r\n"]}