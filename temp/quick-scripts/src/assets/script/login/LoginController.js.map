{"version":3,"sources":["assets/script/login/LoginController.js"],"names":["gameDef","require","singleton","wechatSdk","cc","Class","Component","properties","ProgressBar","type","LabelTip","Label","onLoad","curScene","Scene","Login","node","active","initLoginModule","onClickWxLogin","isWeChat","login","preloadAllScene","self","progressFunc","progress","string","toFixed","console","log","successFuc","director","loadScene","Hall","loadManager","loadAllScene"],"mappings":";;;;;;AAAA,IAAIA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIE,SAAS,GAAGF,OAAO,CAAC,WAAD,CAAvB;;AAEAG,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,WAAW,EAAE;AACTC,MAAAA,IAAI,EAAEL,EAAE,CAACI,WADA;AAET,iBAAS;AAFA,KADL;AAMRE,IAAAA,QAAQ,EAAE;AACND,MAAAA,IAAI,EAAEL,EAAE,CAACO,KADH;AAEN,iBAAS;AAFH;AANF,GAHP;AAeLC,EAAAA,MAfK,oBAeK;AACNV,IAAAA,SAAS,CAACW,QAAV,GAAqBb,OAAO,CAACc,KAAR,CAAcC,KAAnC;AACA,SAAKL,QAAL,CAAcM,IAAd,CAAmBC,MAAnB,GAA4B,KAA5B;AACA,SAAKT,WAAL,CAAiBQ,IAAjB,CAAsBC,MAAtB,GAA+B,KAA/B;AACA,SAAKC,eAAL;AACH,GApBI;AAsBLA,EAAAA,eAtBK,6BAsBc;AACf,SAAKf,SAAL,GAAiB,IAAIA,SAAJ,EAAjB;AACH,GAxBI;AA0BLgB,EAAAA,cA1BK,4BA0Ba;AACd,SAAKT,QAAL,CAAcM,IAAd,CAAmBC,MAAnB,GAA4B,IAA5B;AACA,SAAKT,WAAL,CAAiBQ,IAAjB,CAAsBC,MAAtB,GAA+B,IAA/B;;AACA,QAAI,KAAKd,SAAL,CAAeiB,QAAf,EAAJ,EAA+B;AAC3B,WAAKjB,SAAL,CAAekB,KAAf,CAAqB,YAAY;AAC7B,aAAKC,eAAL;AACH,OAFD;AAGH,KAJD,MAKK;AACD,WAAKA,eAAL;AACH;AACJ,GArCI;AAuCLA,EAAAA,eAvCK,6BAuCc;AACf,QAAIC,IAAI,GAAG,IAAX;;AACA,QAAIC,YAAY,GAAG,SAAfA,YAAe,CAAUC,QAAV,EAAoB;AACnC,UAAI,CAACF,IAAI,CAACf,WAAV,EAAuB;;AACvB,UAAIiB,QAAQ,IAAI,GAAhB,EAAqB;AACjBF,QAAAA,IAAI,CAACf,WAAL,CAAiBiB,QAAjB,GAA4B,GAA5B;AACAF,QAAAA,IAAI,CAACb,QAAL,CAAcgB,MAAd,GAAuB,eAAvB;AACA;AACH;;AACDH,MAAAA,IAAI,CAACf,WAAL,CAAiBiB,QAAjB,GAA4BA,QAA5B;AACAF,MAAAA,IAAI,CAACb,QAAL,CAAcgB,MAAd,GAAuB,gBAAgB,CAACD,QAAQ,GAAG,GAAZ,EAAiBE,OAAjB,CAAyB,CAAzB,CAAhB,GAA8C,GAArE;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgB,CAACJ,QAAQ,GAAG,GAAZ,EAAiBE,OAAjB,CAAyB,CAAzB,CAAhB,GAA8C,GAA1D;AACH,KAVD;;AAYA,QAAIG,UAAU,GAAG,SAAbA,UAAa,GAAY;AACzB1B,MAAAA,EAAE,CAAC2B,QAAH,CAAYC,SAAZ,CAAsBhC,OAAO,CAACc,KAAR,CAAcmB,IAApC;AACH,KAFD;;AAIA/B,IAAAA,SAAS,CAACgC,WAAV,CAAsBC,YAAtB,CAAmCX,YAAnC,EAAiDM,UAAjD;AACH;AA1DI,CAAT","sourceRoot":"/","sourcesContent":["let gameDef = require(\"gameDef\");\nlet singleton = require(\"singleton\");\nlet wechatSdk = require(\"wechatSdk\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        ProgressBar: {\n            type: cc.ProgressBar,\n            default: null\n        },\n\n        LabelTip: {\n            type: cc.Label,\n            default: null\n        }\n    },\n\n    onLoad () {\n        singleton.curScene = gameDef.Scene.Login;\n        this.LabelTip.node.active = false;\n        this.ProgressBar.node.active = false;\n        this.initLoginModule();\n    },\n\n    initLoginModule () {\n        this.wechatSdk = new wechatSdk();\n    },\n\n    onClickWxLogin () {\n        this.LabelTip.node.active = true;\n        this.ProgressBar.node.active = true;\n        if (this.wechatSdk.isWeChat()) {\n            this.wechatSdk.login(function () {\n                this.preloadAllScene();\n            });\n        }\n        else {\n            this.preloadAllScene();\n        }\n    },\n\n    preloadAllScene () {\n        let self = this;\n        let progressFunc = function (progress) {\n            if (!self.ProgressBar) return;\n            if (progress >= 100) {\n                self.ProgressBar.progress = 100;\n                self.LabelTip.string = \"正在进入游戏，请耐心等待～\";\n                return;\n            }\n            self.ProgressBar.progress = progress;\n            self.LabelTip.string = \"正在进入游戏，当前加载\" + (progress * 100).toFixed(2) + \"%\";\n            console.log(\"正在进入游戏，当前加载\" + (progress * 100).toFixed(2) + \"%\");\n        };\n\n        let successFuc = function () {\n            cc.director.loadScene(gameDef.Scene.Hall);\n        };\n\n        singleton.loadManager.loadAllScene(progressFunc, successFuc);\n    }\n\n});\n"]}